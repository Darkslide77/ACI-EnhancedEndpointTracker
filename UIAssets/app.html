<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="locale" content="US">
        <meta name="language" content="en">
        <meta name="country" content="US">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link type="text/css" rel="stylesheet" href="js/lib/select2/select2.min.css">
        <link type="text/css" rel="stylesheet" href="css/cui-1.3.3-official/css/cui-standard.min.css">
        <script type='text/javascript' src='js/lib/jquery-3.1.1.min.js'></script>
        <script type='text/javascript' src='js/lib/json2.js'></script>
        <script type='text/javascript' src='js/lib/js.cookie.js'></script>
        <script type='text/javascript' src='js/lib/knockout-3.4.2.js'></script>
        <script type='text/javascript' src='js/lib/moment.min.js'></script>
        <script type='text/javascript' src='js/lib/select2/select2.full.min.js'></script>
        <script type='text/javascript' src='js/common.js'></script>
        <script type='text/javascript' src='js/ko-table.js'></script>
        <script type='text/javascript' src='js/ept.js'></script>
        <script type='text/javascript' src='js/app.js'></script>
    </head>
    <body class="cui">

    <!-- single modal backdrop required -->
    <div class="modal-backdrop hide"></div>

    <!-- common alert/error modal -->
    <div class="modal modal-alert modal--small hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <div class="modal__body">
                    <div class="alert alert--danger">
                        <div class="alert__icon icon-danger-outline"></div>
                        <div class="alert__message text-left">
                            <div class="half-margin-top">
                                <span class="text-large text-danger">Error</span>
                                <p id="modal-alert-content"></p>
                            </div>
                            <div class="text-center base-margin-top">
                                <button class="btn btn--small btn--gray-ghost" onclick="hideModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- common info modal -->
    <div class="modal modal-info modal--large hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <a class="modal__close" onclick="hideModal()"><span class="icon-close"></span></a>
                <div class="modal__body">
                    <div class="alert">
                        <div class="alert__icon icon-info-outline"></div>
                        <div class="alert__message text-left">
                            <div class="half-margin-top">
                                <p id="modal-info-content"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal__footer">
                    <button class="btn btn btn--gray-ghost" onclick="hideModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- common confirm modal -->
    <div class="modal modal-confirm modal--large hide">
        <div class="modal__dialog">
            <div class="modal__content">
                <a class="modal__close" onclick="hideModal()"><span class="icon-close"></span></a>
                <div class="modal__body">
                    <div class="alert">
                        <div class="alert__icon icon-info-outline"></div>
                        <div class="alert__message text-left">
                            <div class="half-margin-top">
                                <p id="modal-confirm-content"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal__footer">
                    <button class="btn btn btn--gray-ghost" onclick="hideModal()">Close</button>
                    <button class="btn btn btn--gray-ghost" onclick="confirmedModal()">Proceed</button>
                </div>
            </div>
        </div>
    </div>
    
	<!-- page content container -->
    <div class="content-fluid">
        <main>
    		<!-- page header -->
    		<header class="header header--compressed">
    		    <div class="header-bar container">
                    <a class="header-bar__logo">
                        <span class="icon-cisco"></span>
                    </a>
    		        <div class="header-bar__main">
    		            <div class="header-heading">
    		                <h1 class="page-title">Endpoint Tracker</h1>
    		            </div>
    		        </div>
                    <div>
                        <a href="#/" class="btn btn--small btn--icon" data-balloon="Dashboard" data-balloon-pos="down">
                            <span class="icon-computer"></span>
                        </a>
                        <a class="btn btn--small btn--icon" data-balloon="Accounts" data-balloon-pos="down">
                            <span class="icon-user"></span>
                        </a>
                        <a class="btn btn--small btn--icon" data-balloon="Help" data-balloon-pos="down">
                            <span class="icon-help"></span>
                        </a>
                    </div>
    		    </div>
    		</header>
			<!-- end header -->

            <!-- page content -->
            <div class="content content-fluid">
                <div class="container">
                    <div class="section" data-bind="loadingWhen: isLoading">
                        <!-- search (shared by case and decode) -->
                        <div data-bind="">
                            <div class="row text-small">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <div class="form-group__text">
                                            <select  type="search" required id="searchBar"></select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- search end -->

                        <!-- per-endpoint detail pane -->
                        <div data-bind="visible: view_endpoint, loadingWhen: endpoint_isLoading"
                            class="content content--alt half-margin-top half-padding">
                            <blockquote data-bind="visible: current_endpoint_not_found()">
                                    <h3> No data for <span data-bind="text:endpoint_detail_addr"></span>
                                </h3>
                            </blockquote>
                            <blockquote data-bind="visible: !current_endpoint_not_found(), css: current_endpoint.blockquote_css">
                                <h3>
                                    <span class="label--large" data-bind="css: current_endpoint.type_css, text:current_endpoint.type"></span>
                                    <span data-bind="css: current_endpoint.addr_css, text:current_endpoint.addr"></span>
                                </h3>
                                <div class="qtr-margin-top" data-bind="visible: current_endpoint.is_offsubnet">
                                    <span class="label label label--danger">OffSubnet</span>
                                    Nodes:
                                    <span data-bind="foreach: { data: current_endpoint.offsubnet_nodes(), as: 'n' }">
                                        <span class="label label--dkgray" data-bind="text: n"></span>
                                    </span>
                                </div>
                                <div class="qtr-margin-top" data-bind="visible: current_endpoint.is_stale">
                                    <span class="label label label--danger">Stale</span>
                                    Nodes:
                                    <span data-bind="foreach: { data: current_endpoint.stale_nodes(), as: 'n' }">
                                        <span class="label label--dkgray" data-bind="text: n"></span>
                                    </span>
                                </div>
                                <div class="qtr-margin-top" data-bind="visible: current_endpoint.is_rapid">
                                    <span class="label label label--danger">Rapid</span>
                                    triggered at <span data-bind="text: current_endpoint.is_rapid_ts_str"></span>
                                </div>
                                <div class="qtr-margin">
                                    Fabric <span class="text-bold" data-bind="text:current_endpoint.fabric"></span>
                                    <span data-bind="text:current_endpoint.vnid_identifier"></span>
                                    <span class="text-bold" data-bind="text:current_endpoint.vnid_value"></span>
                                    EPG <span class="text-bold" data-bind="text:current_endpoint.epg_name"></span>
                                </div>
                                <div data-bind="visible: current_endpoint.is_deleted()">
                                    <span class="label label--dkgray">Not local on any node</span>
                                </div>
                                <div data-bind="visible: !current_endpoint.is_deleted()">
                                    Local on node <span class="text-bold" data-bind="text:current_endpoint.local_node"></span>
                                    interface <span class="text-bold" data-bind="text: current_endpoint.local_interface"></span>
                                    encap <span class="text-bold" data-bind="text: current_endpoint.local_encap"></span>
                                    <span data-bind="visible: current_endpoint.local_mac().length>0">
                                        mac 
                                        <a data-bind="attr: { href: current_endpoint.local_mac_href }">
                                            <span class="text-bold" data-bind="text: current_endpoint.local_mac"></span>
                                        </a>
                                    </span>
                                </div>
                                <!-- endpoint control -->
                                <div class="half-margin-top">
                                    <button class="btn btn--small btn--secondary" data-bind="
                                            enable: admin_role,
                                            click: function(){endpoint_force_refresh()}
                                            ">
                                        <span class="icon icon-refresh"></span>
                                        Force refresh
                                    </button>
                                    <button class="btn btn--small btn--gray-ghost" data-bind="
                                            enable: admin_role,
                                            click: function(){endpoint_force_delete()}
                                            ">
                                        <span class="icon icon-trash"></span>
                                        Delete events
                                    </button>
                                    <button class="btn btn--small btn--negative" data-bind="
                                            enable: admin_role,
                                            click: function(){endpoint_force_clear()}
                                            ">
                                        <span class="icon icon-exclamation-triangle"></span>
                                        Clear endpoint
                                    </button>
                                </div>
                                <!-- end endpoint control -->
                            </blockquote>
                        </div>
                        <!-- end per-endpoint detail pane -->

                        <!-- dashboard start -->
                        <div class="content content--alt half-margin-top half-padding">

                            <!-- per-endpoint tabs selection -->
                            <div class="qtr-padding" data-bind="visible: view_endpoint"> 
                                <ul class="tabs tabs--bordered">
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('history')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/history' }">
                                            <div class="tab__heading">
                                                <span class="icon-clock"></span>
                                                History
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('detailed')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/detailed' }">
                                            <div class="tab__heading">
                                                <span class="icon-search"></span>
                                                Detailed
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('moves')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/moves' }">
                                            <div class="tab__heading">
                                                <span class="icon-panel-shift-right"></span>
                                                Moves
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('offsubnet')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/offsubnet' }">
                                            <div class="tab__heading">
                                                <span class="icon-jump-out"></span>
                                                OffSubnet
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('stale')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/stale' }">
                                            <div class="tab__heading">
                                                <span class="icon-warning-outline"></span>
                                                Stale
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('rapid')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/rapid' }">
                                            <div class="tab__heading">
                                                <span class="icon-too-fast"></span>
                                                Rapid
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: endpoint_detail_active_tab('remediate')">
                                        <a tabindex="0" data-bind="attr:{ href:endpoint_detail_tab_link()+'/remediate' }">
                                            <div class="tab__heading">
                                                <span class="icon-delete"></span>
                                                Cleared
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!-- end per-endpoint tabs selection -->


                            <!-- dashboard tabs selection -->
                            <div class="qtr-padding" data-bind="visible: view_dashboard"> 
                                <ul class="tabs tabs--bordered">
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_fabric')+dashboard_active_tab('dashboard_fabric_events')">
                                        <a tabindex="0" href="#/">
                                            <div class="tab__heading">
                                                <span class="icon-computer"></span> Fabric
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_endpoints')">
                                        <a tabindex="0" href="#/endpoints">
                                            <div class="tab__heading">
                                                <span class="icon-virtual-machine"></span> Endpoints
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_moves')">
                                        <a tabindex="0" href="#/moves">
                                            <div class="tab__heading">
                                                <span class="icon-panel-shift-right"></span> Moves
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_offsubnet')">
                                        <a tabindex="0" href="#/offsubnet">
                                            <div class="tab__heading">
                                                <span class="icon-jump-out"></span> OffSubnet
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_stale')">
                                        <a tabindex="0" href="#/stale">
                                            <div class="tab__heading">
                                                <span class="icon-warning-outline"></span> Stale
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_rapid')">
                                        <a tabindex="0" href="#/rapid">
                                            <div class="tab__heading">
                                                <span class="icon-too-fast"></span> Rapid
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_remediate')">
                                        <a tabindex="0" href="#/remediate">
                                            <div class="tab__heading">
                                                <span class="icon-delete"></span> Cleared
                                            </div>
                                        </a>
                                    </li>
                                    <li class="tab" data-bind="css: dashboard_active_tab('dashboard_latest_events')">
                                        <a tabindex="0" href="#/events">
                                            <div class="tab__heading">
                                                <span class="icon-analysis"></span> Latest Events
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <!-- dashboard tabs end -->

                            <!-- main table content -->
                            <div class="qtr-padding">
                                <div class="row" data-bind="visible: historical_tab">
                                    <div class="col-md-12">
                                        <div class="alert qtr-margin-top qtr-margin-bottom">
                                            <div class="alert__icon icon-info-outline"></div>
                                            <div class="alert__message" data-bind="">
                                                These are historical records. Check the 
                                                <span class="text-bold">Endpoints</span> tab to
                                                validate the current status.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-5">
                                        <span data-bind="visible: table.back_enabled()">
                                            <button class="btn btn--small btn--icon" data-balloon="Back" data-balloon-pos="up">
                                                <span data-bind="click: function(){table.go_back()}" class="icon-back"></span>
                                            </button>
                                        </span>
                                        <span data-bind="visible: table.refresh_enabled()">
                                            <button class="btn btn--small btn--icon" data-balloon="Refresh" data-balloon-pos="up">
                                                <span data-bind="click: function(){table.refresh_data()}" class="icon-refresh"></span>
                                            </button>
                                        </span>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="half-margin-top" data-bind="visible: table.title().length>0">
                                            <h4 data-bind="text: table.title()"></h4>
                                        </div>
                                    </div>
                                    <div class="col-md-5">
                                        <div class="text-right" data-bind="foreach: { data: table.toggles, as: 'toggle' }">
                                            <div class="qtr-margin form-group form-group--inline">
                                                <label class="switch">
                                                    <input type="checkbox" data-bind="checked: toggle.checked">
                                                    <span class="switch__input"></span>
                                                    <span class="switch__label" data-bind="text: toggle.label"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="responsive-table" data-bind="loadingWhen: table.isLoading()">
                                    <table class="table table--fixed table--wrap table--hover table--highlight">
                                        <thead>
                                            <tr data-bind="foreach: { data: table.headers, as: 'h' }">
                                                <th data-bind="css: h.get_css(),
                                                        style: {width: h.width()}, 
                                                        click: function(){$root.table.toggle_sort(h)}
                                                        ">
                                                    <span data-bind="text: h.title()"></span>
                                                    <span data-bind="css: h.get_sort_css()"></span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody data-bind="foreach: { data: table.get_paged_rows, as: 'r' }">
                                            <tr data-bind="foreach: { data: $root.table.headers, as: 'h' }">
                                                <td>
                                                    <span data-bind="html: r.get_attribute_html(h.name())"></span>
                                                    <span data-bind="visible: h.control().length>0">
                                                        <span data-bind="foreach: { data: h.control, as: 'c' }">
                                                            <button class="btn btn--small btn--icon" 
                                                                    data-bind="css: c.btn_status(),
                                                                               attr: { 
                                                                                'data-balloon': c.balloon, 
                                                                                'data-balloon-pos': c.balloon_pos,
                                                                                'disabled': c.disabled
                                                                               } ">
                                                                <span data-bind="css: c.icon, click: function(){c.click(r.data)}"></span>
                                                            </button>
                                                        </span>
                                                    </span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div data-bind="visible: table.rows().length==0 && table.display_no_data()">
                                        <div class="base-margin-top">
                                            <span data-bind="text: table.no_data_message"></span>
                                        </div>
                                    </div>
                                    <div data-bind="visible: table.page_enabled() && table.get_total_count()>0">
                                        <div class="text-right base-margin">
                                                <div class="pull-left qtr-margin">Total 
                                                    <span class="text-bold" data-bind="text: table.get_total_count()"></span>
                                                    <span data-bind="visible: table.get_total_count_wrapped()>0">
                                                        limited to 
                                                        <span class="text-bold" data-bind="text: table.get_total_count_wrapped()"></span>
                                                    </span>
                                                </div>
                                            <div data-bind="visible: table.get_total_pages()>1">
                                                <a data-bind="click: function(){table.pager('first')}">
                                                    <span class="label label--circle label--info qtr-padding icon-step-backward" ></span>
                                                </a>
                                                <a data-bind="click: function(){table.pager('prev')}">
                                                    <span class="label label--circle label--info qtr-padding icon-step-prev" ></span>
                                                </a>
                                                <span data-bind="foreach: { data: table.get_in_view_pages(), as: 'p' }">
                                                    <a data-bind="click: function(){$root.table.pager(p)}">
                                                        <span class="label qtr-padding" data-bind="text: p, css: $root.table.get_page_css(p)" ></span>
                                                    </a>
                                                </span>
                                                <a data-bind="click: function(){table.pager('next')}">
                                                    <span class="label label--circle label--info qtr-padding icon-step-next" ></span>
                                                </a>
                                                <a data-bind="click: function(){table.pager('last')} ">
                                                    <span class="label label--circle label--info qtr-padding icon-step-forward"></span>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <!-- main table content end -->

                        </div>
                        <!-- dashbarod end -->

                    </div>
                </div>
            </div>
            <!-- end page content  -->
        </main>
    </div>
    <!-- end page content container -->
    </body>
</html>
